import{_ as s,c as n,o as a,a as l}from"./app.2b104437.js";const d=JSON.parse('{"title":"Get started - Shell script","description":"","frontmatter":{},"headers":[{"level":2,"title":"Runtime","slug":"runtime","link":"#runtime","children":[{"level":3,"title":"Docker compose","slug":"docker-compose","link":"#docker-compose","children":[]},{"level":3,"title":"注意事项","slug":"注意事项","link":"#注意事项","children":[]}]},{"level":2,"title":"Basic","slug":"basic","link":"#basic","children":[{"level":3,"title":"授权脚本","slug":"授权脚本","link":"#授权脚本","children":[]},{"level":3,"title":"变量","slug":"变量","link":"#变量","children":[]},{"level":3,"title":"输出","slug":"输出","link":"#输出","children":[]},{"level":3,"title":"分支结构 - if","slug":"分支结构-if","link":"#分支结构-if","children":[]}]},{"level":2,"title":"Demo","slug":"demo","link":"#demo","children":[{"level":3,"title":"文件远程复制","slug":"文件远程复制","link":"#文件远程复制","children":[]}]}],"relativePath":"getting-started/shell-script.md","lastUpdated":1677566836000}'),p={name:"getting-started/shell-script.md"},e=l(`<h1 id="get-started-shell-script" tabindex="-1">Get started - Shell script <a class="header-anchor" href="#get-started-shell-script" aria-hidden="true">#</a></h1><p>关于 Shell 脚本的一些学习笔记。其全部参考于<a href="https://tldp.org/LDP/abs/html/index.html" target="_blank" rel="noreferrer">Advanced Bash-Scripting Guide</a>。</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>部分参数解析参考工具网站：<a href="https://explainshell.com/" target="_blank" rel="noreferrer">explainshell</a></p></div><nav class="table-of-contents"><ul><li><a href="#runtime">Runtime</a><ul><li><a href="#docker-compose">Docker compose</a></li><li><a href="#注意事项">注意事项</a></li></ul></li><li><a href="#basic">Basic</a><ul><li><a href="#授权脚本">授权脚本</a></li><li><a href="#变量">变量</a></li><li><a href="#输出">输出</a></li><li><a href="#分支结构-if">分支结构 - if</a></li></ul></li><li><a href="#demo">Demo</a><ul><li><a href="#文件远程复制">文件远程复制</a></li></ul></li></ul></nav><h2 id="runtime" tabindex="-1">Runtime <a class="header-anchor" href="#runtime" aria-hidden="true">#</a></h2><h3 id="docker-compose" tabindex="-1">Docker compose <a class="header-anchor" href="#docker-compose" aria-hidden="true">#</a></h3><p>本次运行环境使用 Alpine 的 Docker 容器。其 Docker Compose 文件如下：</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki"><code><span class="line"><span style="color:#8BE9FD;">version</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">3.7</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># Please refer to the official documentation:</span></span>
<span class="line"><span style="color:#6272A4;"># https://docs.docker.com/compose/compose-file/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8BE9FD;">networks</span><span style="color:#FF79C6;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#8BE9FD;">default</span><span style="color:#FF79C6;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">driver</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">bridge</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8BE9FD;">services</span><span style="color:#FF79C6;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#8BE9FD;">linux</span><span style="color:#FF79C6;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">image</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">alpine:3.17</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">working_dir</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">/opt/www</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">volumes</span><span style="color:#FF79C6;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#FF79C6;">-</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">.:/opt/www</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">networks</span><span style="color:#FF79C6;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#FF79C6;">-</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">default</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># /dev/null 代表 linux 的空设备文件，所有往这个文件里面写入的内容都会丢失，俗称“黑洞”。</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 那么执行了 &gt;/dev/null 之后，标准输出就会不再存在，没有任何地方能够找到输出的内容。</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;"># 该 entrypoint 命令是为了让容器始终保持在线状态</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">entrypoint</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> [</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">tail</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">-f</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">/dev/null</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="注意事项" tabindex="-1">注意事项 <a class="header-anchor" href="#注意事项" aria-hidden="true">#</a></h3><ul><li>在 Docker 容器中，直接启动该容器时，其用户变量未设置（ex：<code>$UID</code>及<code>$USER</code>的值均为空）</li><li><code>/dev/null</code>代表 linux 的空设备文件，所有往这个文件里面写入的内容都会丢失</li></ul><h2 id="basic" tabindex="-1">Basic <a class="header-anchor" href="#basic" aria-hidden="true">#</a></h2><blockquote><p>关于 shell 脚本中常见的一些用法说明。</p></blockquote><h3 id="授权脚本" tabindex="-1">授权脚本 <a class="header-anchor" href="#授权脚本" aria-hidden="true">#</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#6272A4;"># 授予所有用户对该脚本的「读取/执行」权限</span></span>
<span class="line"><span style="color:#F8F8F2;">$ chmod 555 scriptname</span></span>
<span class="line"><span style="color:#6272A4;"># 等同于</span></span>
<span class="line"><span style="color:#F8F8F2;">$ chmod +rx scriptname</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 仅授予该脚本的拥有者（owner）以对该脚本的「读取/执行」权限</span></span>
<span class="line"><span style="color:#F8F8F2;">$ chmod u+rx scriptname</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="变量" tabindex="-1">变量 <a class="header-anchor" href="#变量" aria-hidden="true">#</a></h3><div class="warning custom-block"><p class="custom-block-title">CAUTION</p><p>变量名不能使用 Shell 里的关键字（可通过<code>help</code>命令查看保留关键字）</p></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>可通过<code>env</code>命令查看<strong>用户环境变量</strong>；通过<code>set</code>命令查看<strong>Shell预定义变量+用户变量</strong>。</p></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#6272A4;">#!/bin/sh</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 设置变量</span></span>
<span class="line"><span style="color:#F8F8F2;">LOG_DIR=/var/log</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 使用变量</span></span>
<span class="line"><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">$LOG_DIR</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="shell-变量" tabindex="-1">Shell 变量 <a class="header-anchor" href="#shell-变量" aria-hidden="true">#</a></h4><table><thead><tr><th>变量</th><th>含义</th></tr></thead><tbody><tr><td><code>$0</code></td><td>当前脚本的文件名</td></tr><tr><td><code>$n</code></td><td>传递给脚本或函数的参数。n 是一个数字，表示第几个参数。<br>例如，第一个参数是<code>$1</code>，第二个参数是<code>$2</code>。</td></tr><tr><td><code>$#</code></td><td>传递给脚本或函数的参数个数</td></tr><tr><td><code>$*</code></td><td>传递给脚本或函数的所有参数。</td></tr><tr><td><code>$?</code></td><td>上个命令的退出状态，或函数的返回值，成功会返回 0，失败返回非 0</td></tr><tr><td><code>$$</code></td><td>当前 Shell 进程 ID，对于 Shell 脚本，就是这些脚本所在的进程 ID</td></tr></tbody></table><h3 id="输出" tabindex="-1">输出 <a class="header-anchor" href="#输出" aria-hidden="true">#</a></h3><br><h4 id="echo" tabindex="-1">echo <a class="header-anchor" href="#echo" aria-hidden="true">#</a></h4><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>详细信息请使用<code>echo -h</code>查看使用帮助。</p></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#6272A4;">#!/bin/sh</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 字符串拼接（使用空格隔开即可）</span></span>
<span class="line"><span style="color:#6272A4;"># shell 脚本中存在大量预定义变量，例如 $USER 为当前用户名</span></span>
<span class="line"><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">当前用户名：</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">$USER</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">当前UID：</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">$UID</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">当前GID：</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">$GID</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 将信息写入某文件</span></span>
<span class="line"><span style="color:#6272A4;"># 文件不存在时创建</span></span>
<span class="line"><span style="color:#6272A4;"># 存在时覆盖</span></span>
<span class="line"><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">Some information...</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">&gt;</span><span style="color:#F8F8F2;"> /var/log/tmp.txt</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="tail" tabindex="-1">tail <a class="header-anchor" href="#tail" aria-hidden="true">#</a></h4><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>详细信息请使用<code>tail -h</code>查看使用帮助。</p></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#6272A4;">#!/bin/sh</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># tail</span></span>
<span class="line"><span style="color:#6272A4;"># 输出文件 $filepath 的最后 $lines 行内容</span></span>
<span class="line"><span style="color:#F8F8F2;">lines=100</span></span>
<span class="line"><span style="color:#F8F8F2;">filepath=/var/log/tmp.log</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">tail -n </span><span style="color:#BD93F9;">$lines</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">$filepath</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="一些条件表达式和运算符" tabindex="-1">一些条件表达式和运算符 <a class="header-anchor" href="#一些条件表达式和运算符" aria-hidden="true">#</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#6272A4;">#!/bin/sh</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">T_NUMBER=1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># -eq 等于</span></span>
<span class="line"><span style="color:#F8F8F2;">OPERATOR=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">-eq 等于</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">[ </span><span style="color:#BD93F9;">$T_NUMBER</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">-eq</span><span style="color:#F8F8F2;"> 1 ] </span><span style="color:#FF79C6;">&amp;&amp;</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#BD93F9;">$OPERATOR</span><span style="color:#F1FA8C;">: INTEGER1 is equal to INTEGER2</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> \\</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">||</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">INTEGER1 is not equal to INTEGER2</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># -ne 不等于</span></span>
<span class="line"><span style="color:#F8F8F2;">OPERATOR=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">-ne 等于</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">[ </span><span style="color:#BD93F9;">$T_NUMBER</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">-ne</span><span style="color:#F8F8F2;"> 0 ] </span><span style="color:#FF79C6;">&amp;&amp;</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#BD93F9;">$OPERATOR</span><span style="color:#F1FA8C;">: INTEGER1 is not equal to INTEGER2</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> \\</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">||</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">INTEGER1 is equal to INTEGER2</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># -gt 大于</span></span>
<span class="line"><span style="color:#F8F8F2;">OPERATOR=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">-gt 大于</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">[ </span><span style="color:#BD93F9;">$T_NUMBER</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">-gt</span><span style="color:#F8F8F2;"> 0 ] </span><span style="color:#FF79C6;">&amp;&amp;</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#BD93F9;">$OPERATOR</span><span style="color:#F1FA8C;">: INTEGER1 is greater than INTEGER2</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> \\</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">||</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">INTEGER1 is less than or equal to INTEGER2</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># -lt 小于</span></span>
<span class="line"><span style="color:#F8F8F2;">OPERATOR=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">-lt 小于</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">[ </span><span style="color:#BD93F9;">$T_NUMBER</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">-lt</span><span style="color:#F8F8F2;"> 2 ] </span><span style="color:#FF79C6;">&amp;&amp;</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#BD93F9;">$OPERATOR</span><span style="color:#F1FA8C;">: INTEGER1 is less than INTEGER2</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> \\</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">||</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">INTEGER1 is greater than or equal to INTEGER2</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># -ge 大于等于</span></span>
<span class="line"><span style="color:#F8F8F2;">OPERATOR=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">-ge 大于等于</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">[ </span><span style="color:#BD93F9;">$T_NUMBER</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">-ge</span><span style="color:#F8F8F2;"> 1 ] </span><span style="color:#FF79C6;">&amp;&amp;</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#BD93F9;">$OPERATOR</span><span style="color:#F1FA8C;">: INTEGER1 is greater than or equal to INTEGER2</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> \\</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">||</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">INTEGER1 is less than INTEGER2</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># -le 小于等于</span></span>
<span class="line"><span style="color:#F8F8F2;">OPERATOR=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">-le 小于等于</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">[ </span><span style="color:#BD93F9;">$T_NUMBER</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">-le</span><span style="color:#F8F8F2;"> 1 ] </span><span style="color:#FF79C6;">&amp;&amp;</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#BD93F9;">$OPERATOR</span><span style="color:#F1FA8C;">: INTEGER1 is less than or equal to INTEGER2</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> \\</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">||</span><span style="color:#F8F8F2;"> </span><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">INTEGER1 is greater than INTEGER2</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h3 id="分支结构-if" tabindex="-1">分支结构 - if <a class="header-anchor" href="#分支结构-if" aria-hidden="true">#</a></h3><p><code>if</code>判断条件使用<code>[]</code>包裹，而不是常见编程语言中的圆括号。并且必须以<code>fi</code>结尾。</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#6272A4;">#!/bin/sh</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 如果命令行参数不为空</span></span>
<span class="line"><span style="color:#6272A4;"># -n the length of STRING is nonzero</span></span>
<span class="line"><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> [ </span><span style="color:#FF79C6;">-n</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#BD93F9;">$1</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> ]</span><span style="color:#FF79C6;">;</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">then</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">the length of STRING is nonzero: </span><span style="color:#BD93F9;">$1</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#FF79C6;">else</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">the length of STRING is zero</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#FF79C6;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 如果命令行参数为空</span></span>
<span class="line"><span style="color:#6272A4;"># -z the length of STRING is zero</span></span>
<span class="line"><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> [ </span><span style="color:#FF79C6;">-z</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#BD93F9;">$1</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> ]</span><span style="color:#FF79C6;">;</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">then</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">the length of STRING is zero</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#FF79C6;">elif</span><span style="color:#F8F8F2;"> [ </span><span style="color:#FF79C6;">-n</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#BD93F9;">$1</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> ]</span><span style="color:#FF79C6;">;</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">then</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">the length of STRING is nonzero: </span><span style="color:#BD93F9;">$1</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#FF79C6;">else</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">It is not possible to reach the condition branch</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#FF79C6;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># Can only exit with status 0-255. Other data should be written to stdout/stderr.</span></span>
<span class="line"><span style="color:#8BE9FD;">exit</span><span style="color:#F8F8F2;"> 0</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="demo" tabindex="-1">Demo <a class="header-anchor" href="#demo" aria-hidden="true">#</a></h2><h3 id="文件远程复制" tabindex="-1">文件远程复制 <a class="header-anchor" href="#文件远程复制" aria-hidden="true">#</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki"><code><span class="line"><span style="color:#6272A4;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">REMOTE_PATH=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">/data/www/runtime/</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">LOCAL_PATH=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">/Users/</span><span style="color:#BD93F9;">$USER</span><span style="color:#F1FA8C;">/logs</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">ENV=test</span></span>
<span class="line"><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> [ </span><span style="color:#FF79C6;">-n</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#BD93F9;">$1</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> ]</span><span style="color:#FF79C6;">;</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">then</span></span>
<span class="line"><span style="color:#F8F8F2;">    ENV=</span><span style="color:#BD93F9;">$1</span></span>
<span class="line"><span style="color:#FF79C6;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> [ </span><span style="color:#E9F284;">&quot;</span><span style="color:#BD93F9;">$ENV</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">==</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">prod</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;"> ]</span><span style="color:#FF79C6;">;then</span></span>
<span class="line"><span style="color:#F8F8F2;">    SERVER_USER=userName1</span></span>
<span class="line"><span style="color:#F8F8F2;">    SERVER_HOST=prod.ap-southeast-1.compute.amazonaws.com</span></span>
<span class="line"><span style="color:#FF79C6;">elif</span><span style="color:#F8F8F2;"> [ </span><span style="color:#E9F284;">&quot;</span><span style="color:#BD93F9;">$ENV</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">==</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">prev</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;"> ]</span><span style="color:#FF79C6;">;then</span></span>
<span class="line"><span style="color:#F8F8F2;">    SERVER_USER=userName2</span></span>
<span class="line"><span style="color:#F8F8F2;">    SERVER_HOST=staging.ap-southeast-1.compute.amazonaws.com</span></span>
<span class="line"><span style="color:#FF79C6;">else</span></span>
<span class="line"><span style="color:#F8F8F2;">    SERVER_USER=userName3</span></span>
<span class="line"><span style="color:#F8F8F2;">    SERVER_HOST=test.ap-east-1.compute.amazonaws.com</span></span>
<span class="line"><span style="color:#F8F8F2;">    REMOTE_PATH=/data/code/runtime/</span></span>
<span class="line"><span style="color:#FF79C6;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8BE9FD;">echo</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">当前拷贝环境：</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">$ENV</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;"> 正在拷贝日志文件至 </span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">$LOCAL_PATH</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">rsync -avzrm --ignore-existing --include=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">*.log</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> --exclude=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">*.php</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> \\</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#BD93F9;">$SERVER_USER</span><span style="color:#F8F8F2;">@</span><span style="color:#BD93F9;">$SERVER_HOST</span><span style="color:#F8F8F2;">:</span><span style="color:#BD93F9;">$REMOTE_PATH</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">$LOCAL_PATH</span><span style="color:#F8F8F2;">/</span><span style="color:#BD93F9;">$ENV</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8BE9FD;">exit</span><span style="color:#F8F8F2;"> 0</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div>`,36),o=[e];function r(c,t,F,i,y,u){return a(),n("div",null,o)}const h=s(p,[["render",r]]);export{d as __pageData,h as default};
